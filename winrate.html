<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Trình tính Winrate RoV (Tiếng Việt)</title>
  <style>
    :root{
      --bg:#ffffff;
      --card:#fff;
      --text:#111;
      --muted:#666;
      --accent:#333;
      --btn-bg:#e9e9e9;
      --btn-text:#111;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    body{
      background:var(--bg);
      color:var(--text);
      margin:0;
      padding:20px;
      display:flex;
      justify-content:center;
      min-height:100vh;
      box-sizing:border-box;
    }
    .container{
      width:100%;
      max-width:720px;
      text-align:left;
    }
    header{
      display:flex;
      gap:16px;
      align-items:center;
      margin-bottom:18px;
    }
    header img.preview{
      width:140px;
      max-width:28%;
      border-radius:8px;
      object-fit:cover;
    }
    h1{
      font-size:32px;
      margin:0;
    }
    p.lead{
      color:var(--muted);
      margin-top:6px;
    }

    .card{
      background:var(--card);
      padding:22px;
      border-radius:10px;
      box-shadow:0 6px 18px rgba(0,0,0,0.06);
      margin-top:16px;
    }

    .field{
      display:flex;
      gap:18px;
      align-items:center;
      margin-bottom:14px;
      flex-wrap:wrap;
    }
    .label{
      min-width:170px;
      color:var(--accent);
      font-weight:600;
    }
    input[type="text"], input[type="number"]{
      padding:10px 12px;
      border-radius:8px;
      border:1px solid #ddd;
      width:250px;
      box-sizing:border-box;
      font-size:15px;
    }
    .actions{
      margin-top:18px;
      display:flex;
      gap:12px;
      align-items:center;
    }
    button{
      padding:10px 18px;
      border-radius:999px;
      border:none;
      background:var(--btn-bg);
      font-weight:600;
      cursor:pointer;
    }
    .result{
      margin-top:18px;
      font-size:18px;
      font-weight:700;
      color:#0b6659;
    }

    @media (max-width:600px){
      header img.preview{ display:none; }
      .label{ min-width:140px; width:100%; }
      .field{ flex-direction:column; align-items:flex-start; }
      input[type="text"], input[type="number"]{ width:100%; }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <img class="preview" src="/mnt/data/985FFD5E-7302-4B6B-864E-625241E9FA57.jpeg" alt="mẫu giao diện gốc" />
      <div>
        <h1>Trình tính Winrate RoV</h1>
        <p class="lead">Nhập winrate hiện tại, winrate mong muốn và tổng số trận đã chơi.</p>
      </div>
    </header>

    <div class="card">
      <div class="field">
        <div class="label">Winrate hiện tại</div>
        <input id="wrCurrent" type="number" min="0" max="100" step="0.01" placeholder="VD: 52 (%)" />
      </div>

      <div class="field">
        <div class="label">Winrate mong muốn</div>
        <input id="wrTarget" type="number" min="0" max="100" step="0.01" placeholder="VD: 60 (%)" />
      </div>

      <div class="field">
        <div class="label">Tổng số trận đã chơi</div>
        <input id="totalGames" type="number" min="0" step="1" placeholder="VD: 500" />
      </div>

      <div class="actions">
        <button id="calcBtn">Tính</button>
        <button id="resetBtn" type="button">Xóa</button>
      </div>

      <div id="output" class="result" aria-live="polite"></div>
    </div>
  </div>

  <script>
    const wrCurrent = document.getElementById('wrCurrent');
    const wrTarget  = document.getElementById('wrTarget');
    const totalGames = document.getElementById('totalGames');
    const calcBtn = document.getElementById('calcBtn');
    const resetBtn = document.getElementById('resetBtn');
    const output = document.getElementById('output');

    function formatNum(n){
      return Math.round(n).toLocaleString();
    }

    calcBtn.addEventListener('click', () => {
      output.textContent = '';

      const wr1 = parseFloat(wrCurrent.value);
      const wr2 = parseFloat(wrTarget.value);
      const T = parseInt(totalGames.value, 10);

      if (isNaN(wr1) || isNaN(wr2) || isNaN(T)) {
        output.style.color = '#b33';
        output.textContent = 'Vui lòng nhập đầy đủ.';
        return;
      }

      if (wr1 < 0 || wr1 > 100 || wr2 < 0 || wr2 > 100) {
        output.style.color = '#b33';
        output.textContent = 'Winrate phải từ 0–100%.';
        return;
      }

      const W = wr1/100 * T;
      const target = wr2/100;

      if (target <= wr1/100) {
        output.style.color = '#0b6659';
        output.textContent = 'Bạn đã đạt winrate mong muốn.';
        return;
      }

      if (target === 1) {
        output.style.color = '#b33';
        output.textContent = 'Không thể đạt 100%.';
        return;
      }

      const numerator = target * T - W;
      const denom = 1 - target;
      const x = numerator / denom;
      const xCeil = Math.max(0, Math.ceil(x));

      output.style.color = '#0b6659';
      output.textContent = `Bạn cần thắng liên tiếp thêm ${formatNum(xCeil)} trận.`;
    });

    resetBtn.addEventListener('click', () => {
      wrCurrent.value = '';
      wrTarget.value = '';
      totalGames.value = '';
      output.textContent = '';
    });
  </script>
</body>
</html>
